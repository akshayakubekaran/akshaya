import matplotlib.pyplot as plt

def estimate_trend(y, d):
    n = len(y)
    trend = [0]*n
    for t in range(n):
        if d % 2 == 1:  # odd d
            sum_y = sum(y[max(0, t-d//2):min(n, t+d//2+1)])
            count = min(t+1, n-t, d)
        else:  # even d
            sum_y = sum(y[max(0, t-d//2+1):min(n, t+d//2+1)])
            count = min(t+1, n-t, d)
        trend[t] = sum_y / count
    return trend

def estimate_seasonality(y, d, trend):
    n = len(y)
    seasonality = [0]*n
    for t in range(n):
        seasonality[t] = y[t] / trend[t]
    return seasonality

# Example usage:
y = [2005,1999,2003,1999,1982,1981,1980,1981,1979,1986,1990,2013,2013,1990,1990,2005,2001,2006,2004,1994,1979,1980,1980,
     1981,1975,1998,1994,2005,2005,1990,1998,1996,1997,1996,1963,1959,1980,2000,2000,2000,1984,1987,2001,1996,1995,1988,
     1998,1984,1988,1988,1988,1988,1994,1993,2010,2010,1986,1986,1986,1986,1988,1998,1998,2003,2019,2003,2007,2004,2007,
     1992,1992,2000,1992,2000,2000,1996,1989,1992,1995,1995,1996,1997,1997,1985,1985,1964,1969,1965,1965,1964,1977,1987,
     1984,1990,1991,1991,1991,1993,1993,1993,1992,2002,2002,1973,1973,1971,1974,1973,1974,1979,1975,1973,2010,2001,2006,
     1995,1995,2000,2001,2007,2007,1999,1999,1999,2001,2009,2000,1996,1996,1996,1998,2005,2001,1984,2015,2001,1988,1988,
     1978,1975,1978,1978,1977,1977,1978,1975,1975,1976,1964,1965,1962,1971,1969,1969,2003,2002,2003,2001,1999,2008,2002,
     2005,2007,1985,1986,1991,1990,1983,1971,1976,1999,1995,2004,2005,2000,1999,1987,2000,2003,1982,1980,1969,1966,2002,
     2004,2004,2003,2003,2004,1999,1985,2000,2002,1986,1989,2005,2009,2009,2009,2009,2009,2009,2008,1992,2000,1985,1989,
     1989,1990,1981,1981,1985,1989,1987,1987,2001,1996,1973,1973,2002,1988,1988,1991,1988,1994,1994,1998,2012,1998,1998,
     1999,2001,1998,2003,2002,1997,1997,2000,2000,2000,2000,2000,2000,2000,2000,2004,2004,2004,2004,2004,2003,2001,2004,
     1987,1989,1989,1989,1987,1999,1993,1984,1997,2000,1984,1992,1997,1989,2009,2008,2000,2000,2019,1999,1987,1989,1987,
     1982,2005,1986,2004,2004,1969,1967,1967,1967,1967,1967,1967,2004,2004,2005,1979,1976,1977,1985,1988,1976,1987,1987,
     1990,1987,2006,2005,2005,2005,1968,1968,1969,2010,2010,1990,1958,2013,2010,2012,2006,2009,2009,2008,1994,2007,1995,1990,1988,2004,2007]
 # Time series data
d = 3  # Number of seasons (odd)
# d = 4  # Number of seasons (even)

trend = estimate_trend(y, d)
seasonality = estimate_seasonality(y, d, trend)

# Plotting
plt.figure(figsize=(10, 6))

plt.subplot(3, 1, 1)
plt.plot(y, label='Original Time Series')
plt.legend()

plt.subplot(3, 1, 2)
plt.plot(trend, label='Trend Component')
plt.legend()

plt.subplot(3, 1, 3)
plt.plot(seasonality, label='Seasonality Component')
plt.legend()

plt.tight_layout()
plt.show()

